<!DOCTYPE html>
<html>
<head>
    <title>Ai Converse</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div class="chat-container">
        <div class="chat-box" id="chat-box">
            <!-- Chat messages will be displayed here -->
        </div>
        <input type="text" id="user-input" placeholder="Type a message...">
        <button onclick="sendMessage()">Send</button>
    </div>

    
    <!-- Your existing HTML structure with modifications -->
<!-- Add CSS classes or IDs where needed for the modifications to work -->

<script>
    function sendMessage() {
        // Fetch user input
        var message = document.getElementById("user-input").value;

        // Display user message in chat with username and timestamp
        var chatBox = document.getElementById("chat-box");
        var userName = "User"; // You can prompt for a username or get it from the user
        var userMessage = '<div class="message user-message">' + message + '</div>';
        var userInformation = '<div class="message-info"><span class="message-info-text">' + userName + ' - ' + getCurrentTime() + '</span></div>';
        var completeUserMessage = '<div class="user-message-wrapper">' + userInformation + userMessage + '</div>';
        chatBox.innerHTML += completeUserMessage;


        // Display 'Typing...' indicator
        chatBox.innerHTML += '<div class="message bot-typing">Desire is typing...</div>';
        chatBox.scrollTop = chatBox.scrollHeight; // Scroll to the bottom

        // Send user input to Python server for processing
        fetch('/send-message', {
            method: 'POST',
            body: JSON.stringify({ message: message }),
            headers: {
                'Content-Type': 'application/json'
            }
        })
        .then(response => response.json())
        .then(data => {
            // Remove 'Typing...' indicator
            var botTypingIndicator = document.querySelector('.bot-typing');
            if (botTypingIndicator) {
                botTypingIndicator.remove();
            }

            // Display GPT-3 response in chat with bot name and timestamp
            var botMessage = '<div class="message bot-message">' + data.message + '</div>';
            var botInformation = '<div class="message-info"><span class="message-info-text">ChatGPT - ' + getCurrentTime() + '</span></div>';
            var completeBotMessage = '<div class="bot-message-wrapper">' + botInformation + botMessage + '</div>';
            chatBox.innerHTML += completeBotMessage;
            chatBox.scrollTop = chatBox.scrollHeight; // Scroll to the bottom
        })
        .catch(error => {
            console.error('Error:', error);
            // Handle error (display an error message in the chat, etc.)
        });

        // Clear input field
        document.getElementById("user-input").value = '';
    }

    // Function to get current time in HH:MM format
    function getCurrentTime() {
        var now = new Date();
        return now.getHours() + ':' + (now.getMinutes() < 10 ? '0' : '') + now.getMinutes();
    }
</script>

</body>
</html>
